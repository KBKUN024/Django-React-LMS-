# 前端开发环境Dockerfile
FROM node:20-alpine

WORKDIR /app

# 复制package文件
COPY frontend/frontend/package.json frontend/frontend/pnpm-lock.yaml ./

# 安装依赖
RUN npm install -g pnpm
RUN pnpm install

# 创建非root用户
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nextjs -u 1001

# 改变目录所有权
RUN chown -R nextjs:nodejs /app
USER nextjs

# 暴露端口
EXPOSE 3000

# 开发模式启动命令，支持热重载
CMD ["pnpm", "run", "dev", "--host", "0.0.0.0", "--port", "3000"]
